# ============================================================
# LogX 业务服务配置示例
# 适用于 Spring Boot Servlet 服务（如 domidodo-realauth）
# ============================================================

logx:
  # 是否启用
  enabled: true

  # ============ 租户信息（必填） ============
  tenant-id: "tenant-001"
  system-id: "domidodo-realauth"
  system-name: "实名认证服务"
  api-key: "your-api-key-here"

  # ============ 通信模式 ============
  # 可选: http 或 grpc
  mode: grpc

  # ============ LogX 服务端配置 ============
  gateway:
    # HTTP 模式配置
    url: http://logx-server:8080

    # gRPC 模式配置
    host: logx-server
    port: 9090
    batch-mode: stream

    # 超时配置
    connect-timeout: 5000
    read-timeout: 5000

  # ============ 分布式追踪配置（新增） ============
  trace:
    # 是否启用（启用后自动接收网关传递的 TraceId）
    enabled: true

  # ============ AOP 自动日志收集 ============
  aspect:
    enabled: true
    controller: true    # 收集 Controller 层日志
    service: false      # 收集 Service 层日志（可选）
    log-args: true      # 记录请求参数
    log-result: true    # 记录响应结果
    slow-threshold: 5000  # 慢请求阈值（毫秒）

  # ============ 用户上下文配置 ============
  user-context:
    enabled: true
    # 获取来源：header, session, principal, parameter
    source:
      - header
      - session
      - principal
    # 请求头名称（与网关保持一致）
    user-id-header: X-User-Id
    user-name-header: X-User-Name
    tenant-id-header: X-Tenant-Id

  # ============ 模块映射 ============
  module:
    enabled: true
    default-module: "实名认证"
    package-mapping:
      com.domidodo.realauth.controller: "实名认证"
      com.domidodo.realauth.service: "实名认证服务"

  # ============ 缓冲配置 ============
  buffer:
    enabled: true
    size: 1000
    flush-interval: 5s
